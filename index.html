<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Countryballs Mariage RPG - Beta 7.0</title>

  <link
    href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Cinzel:wght@600;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’</text></svg>">
</head>

<body>

  <!-- 1. LOADER -->
  <div id="loader">
    <div class="loader-content">
      <div class="logo-text">COUNTRYBALLS RPG</div>
      <div class="spinner"></div>
      <div class="progress-container">
        <div class="progress-fill" id="loader-bar"></div>
      </div>
      <div id="loading-text">Chargement des ressources...</div>
    </div>
  </div>

  <!-- 2. FLASH OVERLAY -->
  <div id="flash-overlay"></div>

  <!-- 3. CANVAS CONFETTI -->
  <canvas id="confetti-canvas"></canvas>

  <!-- 4. APP CONTENT -->
  <div id="app">

    <header class="main-header glass-panel">
      <h1>MARIAGE RPG</h1>
      <p class="subtitle">Ã‰DITION PREMIUM BETA 7.0</p>

      <!-- HEADER BUTTONS (Below title) -->
      <div class="header-buttons">
        <button id="btn-audio" class="audio-btn" title="Activer/DÃ©sactiver le son">ğŸ”‡ Son</button>
        <button id="btn-stats" class="stats-btn" title="Statistiques">ğŸ“Š Stats</button>
        <button id="btn-achievements" class="achievements-btn" title="Mes SuccÃ¨s">ğŸ† <span
            id="achievement-count">0/12</span></button>
        <button id="btn-collection" class="collection-btn" title="Ma Collection">ğŸ’ <span
            id="ring-count">0</span></button>
        <button id="btn-history" class="history-btn" title="Voir l'historique">ğŸ“œ Historique</button>
        <button id="btn-settings" class="settings-btn" title="ParamÃ¨tres">âš™ï¸</button>
      </div>

      <!-- LEVEL / XP DISPLAY -->
      <div class="xp-container">
        <div class="level-badge" id="level-badge">Niv. 1</div>
        <div class="xp-bar-wrapper">
          <div class="xp-bar" id="xp-bar"></div>
        </div>
        <span class="xp-text" id="xp-text">0 / 100 XP</span>
      </div>

      <!-- THEME SELECTOR -->
      <div class="theme-selector">
        <label for="select-theme">ğŸ¨ ThÃ¨me</label>
        <select id="select-theme">
          <option value="default">DÃ©faut (Premium)</option>
          <option value="ubuntu">Ubuntu</option>
          <option value="aero">Windows Aero (7)</option>
          <option value="win95">Windows 95</option>
          <option value="winxp">Windows XP</option>
          <option value="ios">iOS</option>
          <option value="android">Android Material</option>
          <option value="oneui">One UI (Samsung)</option>
          <option value="miui">MIUI (Xiaomi)</option>
          <option value="google">Google Design</option>
        </select>
      </div>
    </header>

    <main class="game-container">

      <!-- JOUEUR -->
      <section class="selection-area">
        <div class="card glass-panel" id="card-player">
          <div class="card-title">JOUEUR</div>

          <div class="gender-toggle" id="gender-p">
            <button class="g-btn active" data-role="player" data-gender="m">ğŸ‘¨ Homme</button>
            <button class="g-btn" data-role="player" data-gender="f">ğŸ€ Femme</button>
          </div>

          <div class="field-group">
            <label>NATION</label>
            <select id="select-country-p"></select>
          </div>

          <div class="field-group">
            <label>IDENTITÃ‰</label>
            <div class="input-row">
              <input type="text" id="name-p" placeholder="PrÃ©nom">
              <input type="text" id="lastname-p" placeholder="Nom">
              <button class="dice-btn" id="btn-dice-p" title="GÃ©nÃ©rer IdentitÃ© IA">ğŸ²</button>
            </div>
          </div>
        </div>

        <!-- CENTRE -->
        <div class="center-stage glass-panel" id="center-panel">

          <div class="visual-stage">
            <div class="ball-container left">
              <img id="img-p" src="" class="ball-img hidden" alt="Joueur">
              <div id="ph-p" class="ball-placeholder">?</div>
            </div>
            <div class="ball-container right">
              <img id="img-part" src="" class="ball-img hidden" alt="Partenaire">
              <div id="ph-part" class="ball-placeholder">?</div>
            </div>
          </div>

          <!-- PARTICLES HEARTS CONTAINER -->
          <div id="particles-hearts"></div>

          <div class="score-circle-wrapper">
            <!-- SVG Fix: viewBox allows padding to prevent cropping stroke -->
            <svg class="score-svg" width="160" height="160" viewBox="0 0 160 160">
              <circle class="bg-ring" cx="80" cy="80" r="70"></circle>
              <circle class="progress-ring" id="ring-progress" cx="80" cy="80" r="70" pathLength="100"></circle>
            </svg>
            <div class="score-text">
              <span id="score-val">0%</span>
              <small>COMPATIBILITÃ‰</small>
            </div>

            <div id="badge-union" class="union-badge">âœ¨ UNION PARFAITE</div>
            <div id="badge-fusion" class="fusion-badge">ğŸ‘‘ FUSION ULTIME</div>
          </div>

          <button id="btn-union" class="btn-action">CÃ‰LÃ‰BRER L'UNION</button>
          <p id="status-msg">En attente des participants...</p>

        </div>

        <!-- PARTENAIRE -->
        <div class="card glass-panel" id="card-partner">
          <div class="card-title">PARTENAIRE</div>

          <div class="gender-toggle" id="gender-part">
            <button class="g-btn" data-role="partner" data-gender="m">ğŸ‘¨ Homme</button>
            <button class="g-btn active" data-role="partner" data-gender="f">ğŸ€ Femme</button>
          </div>

          <div class="field-group">
            <label>NATION</label>
            <select id="select-country-part"></select>
          </div>

          <div class="field-group">
            <label>IDENTITÃ‰</label>
            <div class="input-row">
              <input type="text" id="name-part" placeholder="PrÃ©nom">
              <input type="text" id="lastname-part" placeholder="Nom">
              <button class="dice-btn" id="btn-dice-part" title="GÃ©nÃ©rer IdentitÃ© IA">ğŸ²</button>
            </div>
          </div>
        </div>

      </section>
    </main>
  </div>

  <!-- 5. MODAL UNION -->
  <dialog id="modal-union" class="glass-modal">
    <div class="modal-content">
      <h2 id="modal-title">Mariage cÃ©lÃ©brÃ© ğŸ’</h2>
      <p id="modal-text">La cÃ©rÃ©monie fut un succÃ¨s !</p>
      <button id="btn-modal-close" class="btn-action small-btn">OK</button>
    </div>
  </dialog>

  <!-- 6. MODAL HISTORIQUE -->
  <dialog id="modal-history" class="glass-modal">
    <div class="modal-content history-content">
      <h2>ğŸ“œ Historique des Unions</h2>
      <div id="history-list" class="history-list">
        <!-- Liste injectÃ©e via JS -->
      </div>
      <div class="modal-actions">
        <button id="btn-clear-history" class="btn-text">Effacer</button>
        <button id="btn-history-close" class="btn-action small-btn">Fermer</button>
      </div>
    </div>
  </dialog>

  <!-- 7. MODAL RING CELEBRATION -->
  <dialog id="modal-ring" class="glass-modal ring-modal">
    <div class="modal-content ring-content">
      <div class="ring-beam"></div>
      <div class="ring-display">
        <div class="ring-icon">ğŸ’</div>
        <div class="ring-particles-container" id="ring-particles"></div>
      </div>
      <h2 id="ring-rarity-text" class="ring-rarity-title">LEGENDARY RING</h2>
      <div class="ring-stats">
        <p id="ring-countries"></p>
        <p id="ring-compatibility"></p>
      </div>
      <button id="btn-ring-collect" class="btn-action small-btn">ğŸ’ Collecter</button>
    </div>
  </dialog>

  <!-- 8. MODAL EVENT -->
  <dialog id="modal-event" class="glass-modal event-modal">
    <div class="modal-content event-content">
      <div class="event-icon" id="event-icon">ğŸŒ</div>
      <h2 id="event-title">Ã‰vÃ©nement</h2>
      <p id="event-description" class="event-desc"></p>
      <div id="event-choices" class="event-choices">
        <!-- Choices injected via JS -->
      </div>
    </div>
  </dialog>

  <!-- 9. MODAL ACHIEVEMENTS -->
  <dialog id="modal-achievements" class="glass-modal achievements-modal">
    <div class="modal-content achievements-content">
      <h2>ğŸ† Mes SuccÃ¨s</h2>
      <div class="achievements-progress">
        <span id="achievement-progress-text">0 / 12 dÃ©bloquÃ©s</span>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" id="achievement-progress-bar"></div>
        </div>
      </div>
      <div id="achievements-grid" class="achievements-grid">
        <!-- Achievements injected via JS -->
      </div>
      <button id="btn-achievements-close" class="btn-action small-btn">Fermer</button>
    </div>
  </dialog>

  <!-- 10. MODAL COLLECTION -->
  <dialog id="modal-collection" class="glass-modal collection-modal">
    <div class="modal-content collection-content">
      <h2>ğŸ’ Ma Collection d'Anneaux</h2>
      <div class="collection-stats">
        <div class="stat-item">Total: <span id="total-rings">0</span></div>
        <div class="stat-item">â¤ï¸ <span id="mythic-count">0</span></div>
        <div class="stat-item">ğŸ§¡ <span id="legendary-count">0</span></div>
        <div class="stat-item">ğŸ’œ <span id="epic-count">0</span></div>
        <div class="stat-item">ğŸ’™ <span id="rare-count">0</span></div>
        <div class="stat-item">ğŸ¤ <span id="common-count">0</span></div>
      </div>
      <div id="collection-grid" class="collection-grid">
        <!-- Anneaux injectÃ©s via JS -->
      </div>
      <button id="btn-collection-close" class="btn-action small-btn">Fermer</button>
    </div>
  </dialog>

  <!-- 11. MODAL STATS -->
  <dialog id="modal-stats" class="glass-modal stats-modal">
    <div class="modal-content stats-content">
      <h2>ğŸ“Š Statistiques</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <span class="stat-icon">ğŸ’</span>
          <span class="stat-value" id="stat-marriages">0</span>
          <span class="stat-label">Mariages</span>
        </div>
        <div class="stat-card">
          <span class="stat-icon">ğŸŒ</span>
          <span class="stat-value" id="stat-countries">0/22</span>
          <span class="stat-label">Pays DÃ©couverts</span>
        </div>
        <div class="stat-card">
          <span class="stat-icon">â¤ï¸</span>
          <span class="stat-value" id="stat-avg-compat">0%</span>
          <span class="stat-label">Compat. Moyenne</span>
        </div>
        <div class="stat-card">
          <span class="stat-icon">ğŸ¯</span>
          <span class="stat-value" id="stat-best-compat">0%</span>
          <span class="stat-label">Meilleure Compat.</span>
        </div>
        <div class="stat-card">
          <span class="stat-icon">â­</span>
          <span class="stat-value" id="stat-rare-rate">0%</span>
          <span class="stat-label">Taux LÃ©gendaire+</span>
        </div>
        <div class="stat-card">
          <span class="stat-icon">ğŸ”®</span>
          <span class="stat-value" id="stat-fusions">0/6</span>
          <span class="stat-label">Fusions</span>
        </div>
        <div class="stat-card">
          <span class="stat-icon">âš¡</span>
          <span class="stat-value" id="stat-total-xp">0</span>
          <span class="stat-label">XP Total GagnÃ©</span>
        </div>
        <div class="stat-card">
          <span class="stat-icon">â±ï¸</span>
          <span class="stat-value" id="stat-playtime">0h 0m</span>
          <span class="stat-label">Temps de Jeu</span>
        </div>
      </div>
      <button id="btn-stats-close" class="btn-action small-btn">Fermer</button>
    </div>
  </dialog>

  <!-- 12. MODAL SETTINGS -->
  <dialog id="modal-settings" class="glass-modal settings-modal">
    <div class="modal-content settings-content">
      <h2>âš™ï¸ ParamÃ¨tres</h2>

      <div class="settings-section">
        <h3>ğŸ’¾ Sauvegarde</h3>
        <div class="settings-actions">
          <button id="btn-export" class="btn-action">ğŸ“¥ Exporter la Partie</button>
          <button id="btn-import" class="btn-action">ğŸ“¤ Importer une Partie</button>
          <input type="file" id="import-file" accept=".json" style="display: none;">
        </div>
      </div>

      <div class="settings-section danger-zone">
        <h3>âš ï¸ Zone Dangereuse</h3>
        <button id="btn-reset" class="btn-danger">ğŸ—‘ï¸ RÃ©initialiser Tout</button>
        <p class="danger-warning">Cette action est irrÃ©versible !</p>
      </div>

      <button id="btn-settings-close" class="btn-action small-btn">Fermer</button>
    </div>
  </dialog>

  <!-- SCRIPTS -->
  <script src="audio.js"></script>
  <script src="events.js"></script>
  <script src="visual-fx.js"></script>
  <script src="achievements.js"></script>
  <script src="stats.js"></script>
  <script src="save-manager.js"></script>
  <script src="choices.js"></script>
  <script src="scenario.js"></script>
  <script src="game.js"></script>
</body>

</html>